shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
ls
annoTable = read.csv(paste(getwd(), "data/annotationTable.csv", sep="/"))
annoTable$Annotation2 <- paste0("<a href='",annoTable$URL,"'>",annoTable$Annotation,"</a>")
View(annoTable)
View(annoTable)
write.csv(annoTable, "annoTable2.csv")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
#install.packages("ggpubr")
library("ggpubr")
# checked if any missing values in data
df <- read.csv(file.choose())
# no missing values in data
df <- read.csv("OVERLAP_CYS_2019_2010_502_rFiltered.csv")
setwd("~/Box Sync/CODE_DATA/dir_MAPpaper/HETAs_Cys_isoTOPABPP")
# no missing values in data
setwd("~/Box Sync/CODE_DATA/dir_MAPpaper/HETAs_Cys_isoTOPABPP")
df <- read.csv("OVERLAP_CYS_2019_2010_502_rFiltered.csv")
head(df, 2)
summary(df)
s <- summary(df)
s
write.csv("overlapCys_filtered_dataSummary.csv")
write.csv(s, "overlapCys_filtered_dataSummary.csv")
## Preleminary test to check the test assumptions
# [1] Is the covariation linear?
# pearson (parametric)
pearscat <- ggscatter(df, x = "R_2010", y = "R_2019",
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Cys 2010", ylab = "Cys 2019")
pearscat
# spearman (non parametric)
spearscat <- ggscatter(df, x = "R_2010", y = "R_2019",
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "spearman",
xlab = "Cys 2010", ylab = "Cys 2019")
spearscat
### Shapiro-Wilk normality test for R columns from 2010 & 2019 experiments
shapiro.test(df$R_2010)           # => p =
shapiro.test(df$R_2019)            # => p =
ggqqplot(df$R_2010, ylab = "Cys 2010")
ggsave("overlapCys_qq2010_plot.pdf", width=4, height=3, dpi=300)
qq19 <- ggqqplot(df$R_2019, ylab = "Cys 2019")
qq19
# based on results using pearsons
res <- cor.test(df$R_2010, df$R_2019,
method = "pearson")
res
?ggscatter()
pear <- ggscatter(df, x = "R_2010", y = "R_2019", color="darkred",
fill = "lightred", size = 1, title = "Correlation of CpD Cys reactivity (R) between 2010 and 2019 studies",
ggtheme = theme_bw(),
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Cys 2010", ylab = "Cys 2019")
pear
pear <- ggscatter(df, x = "R_2010", y = "R_2019", color="darkred",
fill = "red", size = 1, title = "Correlation of CpD Cys reactivity (R) between 2010 and 2019 studies",
ggtheme = theme_bw(),
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Cys 2010", ylab = "Cys 2019")
pear
pear <- ggscatter(df, x = "R_2010", y = "R_2019", color="red",
fill = "lightgrey", alpha=0.4, size = 2, title = "Correlation of CpD Cys reactivity (R) between 2010 and 2019 studies",
ggtheme = theme_bw(),
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Cys 2010", ylab = "Cys 2019")
pear
pear <- ggscatter(df, x = "R_2010", y = "R_2019", color="red",
fill = "lightgrey", alpha=0.4, size = 2.5, title = "Correlation of cysteine reactivity (R) profiled in 2010 and 2019 studies",
ggtheme = theme_bw(),
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "CpDCys 2010", ylab = "CpDCys 2019")
pear
pear + theme(panel.grid.minor = element_blank(),panel.grid.major = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"))
pear <- ggscatter(df, x = "R_2010", y = "R_2019", color="darkred",
fill = "lightgrey", alpha=0.4, size = 2.5, title = "Correlation of cysteine reactivity (R) profiled in 2010 and 2019 studies",
ggtheme = theme_bw(),
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "CpDCys 2010", ylab = "CpDCys 2019")
pear + theme(panel.grid.minor = element_blank(),panel.grid.major = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"))
pear <- ggscatter(df, x = "R_2010", y = "R_2019", color="firebrick3",
fill = "lightgrey", alpha=0.4, size = 2.5, title = "Correlation of cysteine reactivity (R) profiled in 2010 and 2019 studies",
ggtheme = theme_bw(),
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "CpDCys 2010", ylab = "CpDCys 2019")
pear + theme(panel.grid.minor = element_blank(),panel.grid.major = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"))
pear <- ggscatter(df, x = "R_2010", y = "R_2019", color="firebrick3",
fill = "lightgrey", alpha=0.4, size = 2.5, title = "Correlation of cysteine reactivity (R) profiled in 2010 and 2019 studies",
ggtheme = theme_bw(),
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "CpDCys 2010", ylab = "CpDCys 2019")
pear + theme(panel.grid.minor = element_blank(),panel.grid.major = element_blank(), panel.background = element_blank())#, axis.line = element_line(colour = "black"))
ggsave("overlapCys_correlation_scatterRed_Pearson.pdf", width = 5, height=5, dpi= 400)
pear <- ggscatter(df, x = "R_2010", y = "R_2019", color="firebrick3",
fill = "lightgrey", alpha=0.4, size = 2.5, title = "Correlation of cysteine reactivity (R) profiled in 2010 and 2019 studies",
ggtheme = theme_bw(),
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "CpDCys 2010", ylab = "CpDCys 2019")
pearfinal <- pear + theme(panel.grid.minor = element_blank(),panel.grid.major = element_blank(), panel.background = element_blank())
pearfinal
pear <- ggscatter(df, x = "R_2010", y = "R_2019", color="firebrick3",
fill = "lightgrey", alpha=0.4, size = 2.5, title = "Correlation of cysteine reactivity (R) profiled in 2010 and 2019 studies",
ggtheme = theme_bw(),
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "CpDCys 2010", ylab = "CpDCys 2019")
pearfinal <- pear + theme(panel.grid.minor = element_blank(),panel.grid.major = element_blank(), panel.background = element_blank(),theme(plot.title = element_text(hjust=0.5), axis.title.x = element_text(size=12, color="black", margin=margin(t=15, b=5)),axis.title.y = element_text(size=12, color="black", margin=margin(t=0, r=15, b=0)), axis.text=element_text(size=10, color="black", margin=margin(t=1, b=1)))
pearfinal
pear <- ggscatter(df, x = "R_2010", y = "R_2019", color="firebrick3",
fill = "lightgrey", alpha=0.4, size = 2.5, title = "Correlation of cysteine reactivity (R) profiled in 2010 and 2019 studies",
ggtheme = theme_bw(),
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "CpDCys 2010", ylab = "CpDCys 2019")
pearfinal <- pear + theme(panel.grid.minor = element_blank(),panel.grid.major = element_blank(), panel.background = element_blank()) + theme(plot.title = element_text(hjust=0.5), axis.title.x = element_text(size=12, color="black", margin=margin(t=15, b=5)),axis.title.y = element_text(size=12, color="black", margin=margin(t=0, r=15, b=0)), axis.text=element_text(size=10, color="black", margin=margin(t=1, b=1)))
pearfinal
pear <- ggscatter(df, x = "R_2010", y = "R_2019", color="firebrick3",
fill = "lightgrey", alpha=0.4, size = 2.5, title = "Correlation of cysteine reactivity (R) profiled in 2010 and 2019 studies",
ggtheme = theme_bw(),
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "CpDCys 2010", ylab = "CpDCys 2019")
pearfinal <- pear + theme(panel.grid.minor = element_blank(),panel.grid.major = element_blank(), panel.background = element_blank()) + theme(plot.title = element_text(hjust=0.5), axis.title.x = element_text(size=12, color="black", margin=margin(t=15, b=5)),axis.title.y = element_text(size=12, color="black", margin=margin(t=1, r=15, b=1)), axis.text=element_text(size=10, color="black", margin=margin(t=1, b=1)))
pearfinal
ggsave("overlapCys_correlation_scatterRed_Pearson.pdf", width = 5, height=5, dpi= 400)
ggsave("overlapCys_correlation_scatterRed_Pearson.pdf", width = 6, height=5, dpi= 400)
pearfinal <- pear + theme(panel.grid.minor = element_blank(),panel.grid.major = element_blank(), panel.background = element_blank()) + theme(plot.title = element_text(hjust=0.5), axis.title.x = element_text(size=12, color="black", margin=margin(t=15, b=5)),axis.title.y = element_text(size=12, color="black", margin=margin(t=1, r=15, b=1)), axis.text=element_text(size=10, color="black", margin=margin(t=1, b=1)))
pearfinal
ggsave("overlapCys_correlation_scatterRed_Pearson.pdf", width = 7, height=5, dpi= 400)
ggsave("overlapCys_correlation_scatterRed_Pearson.png", width = 7, height=5, dpi= 400)
pear <- ggscatter(df, x = "R_2010", y = "R_2019", color="firebrick3",
fill = "lightgrey", alpha=0.4, size = 2.5, title = "Pearson's correlation of CpD cysteine reactivity (n=500)",
ggtheme = theme_bw(),
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Cys reactivity (2010)", ylab = "Cys reactivity (2019)")
pearfinal <- pear + theme(panel.grid.minor = element_blank(),panel.grid.major = element_blank(), panel.background = element_blank()) + theme(plot.title = element_text(hjust=0.5), axis.title.x = element_text(size=12, color="black", margin=margin(t=15, b=5)),axis.title.y = element_text(size=12, color="black", margin=margin(t=1, r=15, b=1)), axis.text=element_text(size=10, color="black", margin=margin(t=1, b=1)))
pearfinal
pear <- ggscatter(df, x = "R_2010", y = "R_2019", color="firebrick3",
fill = "lightgrey", alpha=0.4, size = 2.5, title = "Pearson's correlation of CpD cysteine reactivity (n=502)",
ggtheme = theme_bw(),
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Cys reactivity (2010)", ylab = "Cys reactivity (2019)")
pearfinal <- pear + theme(panel.grid.minor = element_blank(),panel.grid.major = element_blank(), panel.background = element_blank()) + theme(plot.title = element_text(hjust=0.5), axis.title.x = element_text(size=12, color="black", margin=margin(t=15, b=5)),axis.title.y = element_text(size=12, color="black", margin=margin(t=1, r=15, b=1)), axis.text=element_text(size=10, color="black", margin=margin(t=1, b=1)))
pearfinal
ggsave("overlapCys_correlation_scatterRed_Pearson.png", width = 7, height=5, dpi= 400)
ggsave("overlapCys_correlation_scatterRed_Pearson.pdf", width = 7, height=5, dpi= 400)
shiny::runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
addResourcePath("vid", directoryPath = './www')
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
mtcars
mtcars %>% filter(gear == 4)
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
aadf <- read.csv(paste(getwd(),
"data/AAlevel_CpDAA_undetected_4526UKBID.csv",sep="/"))
runApp()
runApp()
runApp()
runApp()
xref <- read.csv(paste(getwd(),
"data/proteinLevel_xref_4526IDs.csv",sep="/"))
xref
names(xref)
xref <- read.csv(paste(getwd(),
"data/proteinLevel_xref_4526IDs.csv",sep="/")) %>%
select(matched.UKBID, CpDK.count, CpDC.count,
everCpDAA.count,Gene.UKB, Protein.UKB,
OMIM, gene.UKBID, Canonical.pro.isoform, CCDS,
RefSeq, GO.biologicalProcess,GO.cellularComponent,
GO.moleculeFunction, PDB.xref.UKB,
ENST.85,
pLI, oe_lof_upper, max_af,
exac_pLI, brain_expression)
xref
xref %>% filter(matched.UKBID=='P11413')
g6pd = xref %>% filter(matched.UKBID=='P11413')
g = data.frame(t(g6pd))
View(g)
View(g)
names(g) <- "ID"
g
View(g)
View(g)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
shiny::runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
shiny::runApp()
